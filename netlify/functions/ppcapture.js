!function(e,t){for(var s in t)e[s]=t[s]}(exports,function(e){var t={};function s(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,s),n.l=!0,n.exports}return s.m=e,s.c=t,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(r,n,function(t){return e[t]}.bind(null,n));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=142)}([,function(e,t){e.exports=require("querystring")},,function(e,t,s){"use strict";const r=s(9);class n extends r.Environment{constructor(e,t,s,r){super(s),this.clientId=e,this.clientSecret=t,this.webUrl=r}authorizationString(){return"Basic "+new Buffer(`${this.clientId}:${this.clientSecret}`).toString("base64")}}e.exports={PayPalEnvironment:n,LiveEnvironment:class extends n{constructor(e,t){super(e,t,"https://api.paypal.com","https://www.paypal.com")}},SandboxEnvironment:class extends n{constructor(e,t){super(e,t,"https://api.sandbox.paypal.com","https://www.sandbox.paypal.com")}}}},function(e,t,s){"use strict";let r=s(10);e.exports={Encoder:class{constructor(e){this._encoders=e}serializeRequest(e){let t=e.headers["content-type"];if(!t)throw new Error("HttpRequest does not have Content-Type header set");let s=this._encoder(t);if(!s)throw new Error(`Unable to serialize request with Content-Type ${t}. Supported encodings are ${this.supportedEncodings()}`);let n=e.headers["content-encoding"],o=s.encode(e);return"gzip"===n?r.gzipSync(o):o}deserializeResponse(e,t){let s=t["content-type"];if(!s)throw new Error("HttpRequest does not have Content-Type header set");s=s.toLowerCase();let r=this._encoder(s);if(!r)throw new Error(`Unable to deserialize response with Content-Type ${s}. Supported decodings are ${this.supportedEncodings()}`);return r.decode(e)}supportedEncodings(){return"["+this._encoders.map(e=>e.contentType().toString()).join(", ")+"]"}_encoder(e){for(let t=0;t<this._encoders.length;t++){let s=this._encoders[t];if(s.contentType().test(e))return s}return null}}}},function(e,t){e.exports=require("events")},,function(e,t,s){"use strict";e.exports={AccessToken:class{constructor(e){this._accessToken=e.access_token,this._tokenType=e.token_type,this._expiresIn=1e3*e.expires_in,this._dateCreated=Date.now()}isExpired(){return Date.now()>this._dateCreated+this._expiresIn-500}authorizationString(){return`${this._tokenType} ${this._accessToken}`}}}},function(e,t,s){"use strict";e.exports={AccessTokenRequest:class{constructor(e,t){let s={grant_type:"client_credentials"};t&&(s={grant_type:"refresh_token",refresh_token:t}),this.path="/v1/oauth2/token",this.body=s,this.verb="POST",this.headers={"Content-Type":"application/x-www-form-urlencoded",Authorization:e.authorizationString()}}}}},function(e,t,s){"use strict";e.exports=s(23)},function(e,t){e.exports=require("zlib")},function(e,t,s){"use strict";e.exports.Json=class{encode(e){return JSON.stringify(e.body)}decode(e){return JSON.parse(e)}contentType(){return/^application\/json/}}},function(e,t,s){"use strict";e.exports.Text=class{encode(e){return"string"==typeof e.body?e.body:e.body.toString()}decode(e){return"string"==typeof e?e:e.toString()}contentType(){return/^text\/.*/}}},function(e,t,s){"use strict";let r=s(28),n=s(16),o=s(4).Encoder,i=s(11).Json,a=s(12).Text,c=s(14).FormEncoded;class u{constructor(e,t){this.headers={},this.value=e,Object.keys(t).forEach(e=>{this.headers[e.toLowerCase().split("-").map(e=>e[0].toUpperCase()+e.slice(1)).join("-")]=t[e]})}}class h{static get _CRLF(){return"\r\n"}encode(e){let t=null,s=[],n=[],o="boundary"+Date.now();e.headers["content-type"]+="; boundary="+o;for(const t of Object.keys(e.body)){let i=e.body[t];i instanceof r.ReadStream?s.push(this._filePart(t,i,o,e)):n.push(this._formPart(t,i,o,e))}return t=n.concat(s),t.push(Buffer.from(`--${o}--`)),t.push(Buffer.from(h._CRLF)),t.push(Buffer.from(h._CRLF)),Buffer.concat(t)}formatHeaders(e){if(null==e)return e;let t={};return Object.keys(e).forEach((function(s){null!=s&&(t[s.toLowerCase()]=e[s])})),t}decode(){throw new Error("Multipart does not support deserialization.")}contentType(){return/^multipart\/.*/}_filePart(e,t,s,o){return Buffer.concat([Buffer.from(this._partHeader(e,n.basename(t.path),s,o)),r.readFileSync(t.path),Buffer.from(h._CRLF)])}_formPart(e,t,s,r){let n=null,p=null,d=null,l=new o([new i,new a,new c]),f=this.formatHeaders(t.headers);if(t instanceof u&&(n=f["content-type"],p=t.value),n){let e=l.serializeRequest({body:p,headers:f});d=Buffer.from(e+h._CRLF)}else d=Buffer.from(t+h._CRLF);return Buffer.concat([Buffer.from(this._partHeader(e,null,s,r)),d])}_partHeader(e,t,s,r){let n=r.body[e],o="--"+s;if(o+=h._CRLF,o+=`Content-Disposition: form-data; name="${e}"`,t&&(o+=`; filename="${t}"`,o+=h._CRLF,o+="Content-Type: "+this._filetype(t)),n instanceof u){let t=n.headers;"application/json"===t["Content-Type"]&&(o+=`; filename="${e}.json"`);for(const e of Object.keys(t))o+=h._CRLF,o+=e+": "+t[e]}return o+=`${h._CRLF}${h._CRLF}`,o}_filetype(e){let t=n.extname(e);return".jpeg"===t||".jpg"===t?"image/jpeg":".png"===t?"image/png":".gif"===t?"image/gif":".pdf"===t?"application/pdf":"application/octet-stream"}}e.exports={Multipart:h,FormPart:u}},function(e,t,s){"use strict";const r=s(1);e.exports.FormEncoded=class{contentType(){return/^application\/x-www-form-urlencoded/}encode(e){let t=[];for(const s of Object.keys(e.body))t.push(`${s}=${r.escape(e.body[s])}`);return t.join("&")}decode(){throw new Error("FormEncoded does not support deserialization")}}},function(e,t,s){"use strict";const r=s(5).EventEmitter,n={};class o{static cacheForEnvironment(e,t){let s=e.clientId;return t&&(s+="_"+t),n[s]||(n[s]=new o),n[s]}constructor(){this._token=null,this._locked=!1,this._requests=[],this._emitter=new r,this._emitter.setMaxListeners(0)}getToken(){return this._token}setToken(e){this._token=e}lock(){this._locked=!0}unlock(){this._locked=!1}isLocked(){return this._locked}isValid(){return this.isPresent()&&!this._token.isExpired()}isPresent(){return Boolean(this._token)}wait(e){return this._requests.push(e),new Promise((t,s)=>{const r=s=>{e===s&&(this._emitter.removeListener("complete",r),t(e))},n=e=>{this._emitter.removeListener("fail",n),s(e)};this._emitter.on("complete",r),this._emitter.on("fail",n)})}notify(e){e?this._emitter.emit("fail",e):this._requests.forEach(e=>this._emitter.emit("complete",e)),this._requests=[],this._emitter.removeAllListeners()}}e.exports={TokenCache:o}},function(e,t){e.exports=require("path")},,function(e,t){e.exports=require("http")},function(e,t){e.exports=require("https")},function(e,t,s){"use strict";e.exports=s(21)},function(e,t,s){"use strict";e.exports={core:s(22),orders:s(32),payments:s(39)}},function(e,t,s){"use strict";e.exports={AccessToken:s(7).AccessToken,AccessTokenRequest:s(8).AccessTokenRequest,PayPalEnvironment:s(3).PayPalEnvironment,LiveEnvironment:s(3).LiveEnvironment,SandboxEnvironment:s(3).SandboxEnvironment,PayPalHttpClient:s(29).PayPalHttpClient,RefreshTokenRequest:s(31).RefreshTokenRequest,TokenCache:s(15).TokenCache}},function(e,t,s){"use strict";let r=s(24).Environment,n=s(25).HttpClient,o=s(4).Encoder,i=s(13).FormPart;e.exports={Environment:r,HttpClient:n,Encoder:o,FormPart:i}},function(e,t,s){"use strict";e.exports={Environment:class{constructor(e){this.baseUrl=e}}}},function(e,t,s){"use strict";let r=s(18),n=s(19),o=s(26).Buffer,i=s(27),a=s(4).Encoder,c=s(10),u=s(11).Json,h=s(12).Text,p=s(13).Multipart,d=s(14).FormEncoded;class l extends Error{constructor(e){super(),this.message=e.message||e.text||"An unknown error occured.",this.statusCode=e.statusCode,this.headers=e.headers,this._originalError=e}}e.exports={HttpClient:class{constructor(e){this.environment=e,this._injectors=[],this.encoder=new a([new u,new h,new p,new d])}getUserAgent(){return"PayPalHttp-Node HTTP/1.1"}getTimeout(){return 3e4}addInjector(e){if("function"!=typeof e||1!==e.length)throw new Error("injector must be a function that takes one argument");this._injectors.push(e)}formatHeaders(e){let t={};return Object.keys(e).forEach((function(s){null!=s&&("content-type"===s.toLowerCase()?t[s.toLowerCase()]=e[s].toLowerCase():t[s.toLowerCase()]=e[s])})),t}mapHeader(e,t){return Object.keys(e).forEach((function(s){if(null!=s){let r=s.toLowerCase();null!=t[r]&&(e[s]=t[r])}})),e}execute(e){let t=Object.assign({},e);t.headers||(t.headers={});let s,a,u=this._injectors.map((function(e){return e(t)})),h=this.environment.baseUrl.startsWith("https")?n:r,p=i.parse(this.environment.baseUrl);t.host=p.hostname,t.port=p.port;let d=this.formatHeaders(t.headers);if(d["user-agent"]&&"Node"!==d["user-agent"]||(t.headers["User-Agent"]=this.getUserAgent()),t.body){let e=t.headers;t.headers=d,s=this.encoder.serializeRequest(t),t.headers=this.mapHeader(e,d),t.headers["Content-Length"]=o.byteLength(s).toString()}return t.verb&&(t.method=t.verb),new Promise((e,r)=>Promise.all(u).then(()=>{let n=h.request(t,t=>{let s=[];t.on("data",e=>{s.push(e)}),t.on("end",()=>{d=this.formatHeaders(t.headers);let n=d["content-encoding"],i=o.concat(s);"gzip"===n&&(i=c.gunzipSync(i)),i=i.toString("utf8"),t.statusCode>=200&&t.statusCode<=299?e(this._parseResponse(i,t,d)):r(new l({text:i,statusCode:t.statusCode,headers:t.headers}))}),t.on("error",r)});function i(){n.abort(),a=!0,r(new Error("Request timed out"))}n.setTimeout(this.getTimeout(),i);let u=null;n.on("socket",e=>{u=e}),n.on("error",e=>{a||(u.removeListener("timeout",i),r(e))}),s&&n.write(s),n.end()}).catch(r))}_parseResponse(e,t,s){var r={statusCode:t.statusCode,headers:t.headers};return e&&(r.result=this.encoder.deserializeResponse(e,s)),r}}}},function(e,t){e.exports=require("buffer")},function(e,t){e.exports=require("url")},function(e,t){e.exports=require("fs")},function(e,t,s){"use strict";const r=s(9),n=s(7).AccessToken,o=s(8).AccessTokenRequest,i=s(30).version,a=s(15).TokenCache;class c extends r.HttpClient{constructor(e,t){super(e),this._cache=a.cacheForEnvironment(e,t),this.refreshToken=t,this.addInjector(u.bind(this)),this.addInjector((function(e){e.headers["Accept-Encoding"]="gzip",e.headers.sdk_name="Checkout SDK",e.headers.sdk_version="1.0.3",e.headers.sdk_tech_stack="NodeJS "+process.version,e.headers.api_integration_type="PAYPALSDK"}))}getUserAgent(){return"PayPalSDK/PayPal-node-SDK "+i+" (node "+process.version+"-"+process.arch+"-"+process.platform+"; OpenSSL "+process.versions.openssl+")"}execute(e){return super.execute(e).catch(t=>401===t.statusCode?this._retryRequest(e):Promise.reject(t))}_retryRequest(e){const t=this._cache.wait(e).then(()=>(this._setAuthHeader(e),super.execute(e)));return this._cache.isLocked()?t:Promise.race([this.fetchAccessToken(),t]).then(()=>t)}fetchAccessToken(){return this._cache.lock(),super.execute(new o(this.environment,this.refreshToken)).then(e=>{const t=new n(e.result);return this._cache.setToken(t),this._cache.notify(),this._cache.unlock(),t}).catch(e=>(this._cache.setToken(null),this._cache.notify(e),this._cache.unlock(),Promise.reject(e)))}_setAuthHeader(e){const t=this._cache.getToken();e.headers=e.headers||{},e.headers.Authorization=t.authorizationString()}}function u(e){if(!e.headers.Authorization)if(this._cache.isValid())this._setAuthHeader(e);else{if(this._cache.isLocked())return this._cache.wait(e).then(()=>this._setAuthHeader(e));if(!this._cache.isValid())return Promise.all([this._cache.wait(e),this.fetchAccessToken()]).then(()=>this._setAuthHeader(e))}}e.exports={PayPalHttpClient:c}},function(e){e.exports=JSON.parse('{"name":"@paypal/checkout-server-sdk","version":"1.0.3","description":"NodeJS SDK for PayPal Checkout APIs","keywords":[],"homepage":"https://github.com/paypal/Checkout-NodeJS-SDK#readme","author":"dl-paypal-checkout-api@paypal.com (https://developer.paypal.com/)","main":"index","directories":{"lib":"lib"},"repository":{"type":"git","url":"https://github.com/paypal/Checkout-NodeJS-SDK.git"},"engines":{"node":">=8"},"dependencies":{"@paypal/paypalhttp":"^1.0.1"},"devDependencies":{"btoa":"^1.2.1","chai":"^4.1.2","dirty-chai":"^2.0.1","eslint":"^2.7.0","eslint-config-braintree":"^1.0.0","mocha":"^5.2.0","prompt":"^1.0.0","nock":"^9.6.1","sinon":"^2.3.2"},"license":"SEE LICENSE IN https://github.com/paypal/Checkout-NodeJS-SDK/blob/master/LICENSE","scripts":{"test:integration":"mocha spec --recursive","test":"npm run test:integration","test:orders":"mocha spec/orders --recursive --timeout 60000"},"bugs":{"url":"https://github.com/paypal/Checkout-NodeJS-SDK/issues"}}')},function(e,t,s){"use strict";e.exports={RefreshTokenRequest:class{constructor(e,t){let s={grant_type:"authorization_code",code:t};this.headers={"Content-Type":"application/x-www-form-urlencoded",Authorization:e.authorizationString()},this.path="/v1/identity/openidconnect/tokenservice",this.body=s,this.verb="POST"}}}},function(e,t,s){"use strict";e.exports={OrdersAuthorizeRequest:s(33).OrdersAuthorizeRequest,OrdersCaptureRequest:s(34).OrdersCaptureRequest,OrdersCreateRequest:s(35).OrdersCreateRequest,OrdersGetRequest:s(36).OrdersGetRequest,OrdersPatchRequest:s(37).OrdersPatchRequest,OrdersValidateRequest:s(38).OrdersValidateRequest}},function(e,t,s){"use strict";const r=s(1);e.exports={OrdersAuthorizeRequest:class{constructor(e){this.path="/v2/checkout/orders/{order_id}/authorize?",this.path=this.path.replace("{order_id}",r.escape(e)),this.verb="POST",this.body=null,this.headers={"Content-Type":"application/json"}}payPalClientMetadataId(e){return this.headers["PayPal-Client-Metadata-Id"]=e,this}payPalRequestId(e){return this.headers["PayPal-Request-Id"]=e,this}prefer(e){return this.headers.Prefer=e,this}requestBody(e){return this.body=e,this}}}},function(e,t,s){"use strict";const r=s(1);e.exports={OrdersCaptureRequest:class{constructor(e){this.path="/v2/checkout/orders/{order_id}/capture?",this.path=this.path.replace("{order_id}",r.escape(e)),this.verb="POST",this.body=null,this.headers={"Content-Type":"application/json"}}payPalClientMetadataId(e){return this.headers["PayPal-Client-Metadata-Id"]=e,this}payPalRequestId(e){return this.headers["PayPal-Request-Id"]=e,this}prefer(e){return this.headers.Prefer=e,this}requestBody(e){return this.body=e,this}}}},function(e,t,s){"use strict";s(1);e.exports={OrdersCreateRequest:class{constructor(){this.path="/v2/checkout/orders?",this.verb="POST",this.body=null,this.headers={"Content-Type":"application/json"}}payPalPartnerAttributionId(e){return this.headers["PayPal-Partner-Attribution-Id"]=e,this}prefer(e){return this.headers.Prefer=e,this}requestBody(e){return this.body=e,this}}}},function(e,t,s){"use strict";const r=s(1);e.exports={OrdersGetRequest:class{constructor(e){this.path="/v2/checkout/orders/{order_id}?",this.path=this.path.replace("{order_id}",r.escape(e)),this.verb="GET",this.body=null,this.headers={"Content-Type":"application/json"}}}}},function(e,t,s){"use strict";const r=s(1);e.exports={OrdersPatchRequest:class{constructor(e){this.path="/v2/checkout/orders/{order_id}?",this.path=this.path.replace("{order_id}",r.escape(e)),this.verb="PATCH",this.body=null,this.headers={"Content-Type":"application/json"}}requestBody(e){return this.body=e,this}}}},function(e,t,s){"use strict";const r=s(1);e.exports={OrdersValidateRequest:class{constructor(e){this.path="/v2/checkout/orders/{order_id}/validate-payment-method?",this.path=this.path.replace("{order_id}",r.escape(e)),this.verb="POST",this.body=null,this.headers={"Content-Type":"application/json"}}payPalClientMetadataId(e){return this.headers["PayPal-Client-Metadata-Id"]=e,this}requestBody(e){return this.body=e,this}}}},function(e,t,s){"use strict";e.exports={AuthorizationsCaptureRequest:s(40).AuthorizationsCaptureRequest,AuthorizationsGetRequest:s(41).AuthorizationsGetRequest,AuthorizationsReauthorizeRequest:s(42).AuthorizationsReauthorizeRequest,AuthorizationsVoidRequest:s(43).AuthorizationsVoidRequest,CapturesGetRequest:s(44).CapturesGetRequest,CapturesRefundRequest:s(45).CapturesRefundRequest,RefundsGetRequest:s(46).RefundsGetRequest}},function(e,t,s){"use strict";const r=s(1);e.exports={AuthorizationsCaptureRequest:class{constructor(e){this.path="/v2/payments/authorizations/{authorization_id}/capture?",this.path=this.path.replace("{authorization_id}",r.escape(e)),this.verb="POST",this.body=null,this.headers={"Content-Type":"application/json"}}payPalRequestId(e){return this.headers["PayPal-Request-Id"]=e,this}prefer(e){return this.headers.Prefer=e,this}requestBody(e){return this.body=e,this}}}},function(e,t,s){"use strict";const r=s(1);e.exports={AuthorizationsGetRequest:class{constructor(e){this.path="/v2/payments/authorizations/{authorization_id}?",this.path=this.path.replace("{authorization_id}",r.escape(e)),this.verb="GET",this.body=null,this.headers={"Content-Type":"application/json"}}}}},function(e,t,s){"use strict";const r=s(1);e.exports={AuthorizationsReauthorizeRequest:class{constructor(e){this.path="/v2/payments/authorizations/{authorization_id}/reauthorize?",this.path=this.path.replace("{authorization_id}",r.escape(e)),this.verb="POST",this.body=null,this.headers={"Content-Type":"application/json"}}payPalRequestId(e){return this.headers["PayPal-Request-Id"]=e,this}prefer(e){return this.headers.Prefer=e,this}requestBody(e){return this.body=e,this}}}},function(e,t,s){"use strict";const r=s(1);e.exports={AuthorizationsVoidRequest:class{constructor(e){this.path="/v2/payments/authorizations/{authorization_id}/void?",this.path=this.path.replace("{authorization_id}",r.escape(e)),this.verb="POST",this.body=null,this.headers={"Content-Type":"application/json"}}}}},function(e,t,s){"use strict";const r=s(1);e.exports={CapturesGetRequest:class{constructor(e){this.path="/v2/payments/captures/{capture_id}?",this.path=this.path.replace("{capture_id}",r.escape(e)),this.verb="GET",this.body=null,this.headers={"Content-Type":"application/json"}}}}},function(e,t,s){"use strict";const r=s(1);e.exports={CapturesRefundRequest:class{constructor(e){this.path="/v2/payments/captures/{capture_id}/refund?",this.path=this.path.replace("{capture_id}",r.escape(e)),this.verb="POST",this.body=null,this.headers={"Content-Type":"application/json"}}payPalRequestId(e){return this.headers["PayPal-Request-Id"]=e,this}prefer(e){return this.headers.Prefer=e,this}requestBody(e){return this.body=e,this}}}},function(e,t,s){"use strict";const r=s(1);e.exports={RefundsGetRequest:class{constructor(e){this.path="/v2/payments/refunds/{refund_id}?",this.path=this.path.replace("{refund_id}",r.escape(e)),this.verb="GET",this.body=null,this.headers={"Content-Type":"application/json"}}}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,s){"use strict";s.r(t),s.d(t,"handler",(function(){return i}));const{URL:r}=process.env;var n=s(20);function o(){return new n.core.PayPalHttpClient(function(){let e=process.env.PP_CLIENT_ID||"PP_CLIENT_ID",t=process.env.PP_CLIENT_SECRET||"PP__CLIENT_SECRET";return"Live"==process.env.PP_SANDBOX_LIVE?new n.core.LiveEnvironment(e,t):new n.core.SandboxEnvironment(e,t)}())}async function i(e,t){if("GET"!=e.httpMethod)return{statusCode:405,body:"You are not using a http GET method for this endpoint.",headers:{Allow:"GET"}};let s={};try{s=JSON.parse(e.body)}catch(t){s=parse(e.body)}if(!s.token)return{statusCode:400,body:"Wrong usage of parameters."};return async function(e){request=new n.orders.OrdersCaptureRequest(e),request.requestBody({});await o().execute(request)}(s.token),{statusCode:303,headers:{location:r+"/"}}}}]));